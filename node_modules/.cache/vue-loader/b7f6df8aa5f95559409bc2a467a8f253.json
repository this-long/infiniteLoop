{"remainingRequest":"D:\\a-my-html\\html-Vue\\VUE\\VUE-project\\腾讯云\\新建文件夹\\infiniteLoop\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\a-my-html\\html-Vue\\VUE\\VUE-project\\腾讯云\\新建文件夹\\infiniteLoop\\src\\views\\TopicLong.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\a-my-html\\html-Vue\\VUE\\VUE-project\\腾讯云\\新建文件夹\\infiniteLoop\\src\\views\\TopicLong.vue","mtime":1624791998188},{"path":"D:\\a-my-html\\html-Vue\\VUE\\VUE-project\\腾讯云\\新建文件夹\\infiniteLoop\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"D:\\a-my-html\\html-Vue\\VUE\\VUE-project\\腾讯云\\新建文件夹\\infiniteLoop\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\a-my-html\\html-Vue\\VUE\\VUE-project\\腾讯云\\新建文件夹\\infiniteLoop\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQgYXhpb3MgZnJvbSAiYXhpb3MiOw0KaW1wb3J0IEhvbWVOYXYgZnJvbSAiLi4vY29tcG9uZW50cy9Ib21lTmF2LnZ1ZSI7DQppbXBvcnQgTGl0dGxlSGVhZGVyIGZyb20gIi4uL2NvbXBvbmVudHMvTGl0dGxlSGVhZGVyLnZ1ZSI7DQppbXBvcnQgRWRpdG9yIGZyb20gIkB0aW55bWNlL3RpbnltY2UtdnVlIjsNCmltcG9ydCB7IG1hcE11dGF0aW9ucywgbWFwU3RhdGUgfSBmcm9tICJ2dWV4IjsNCmV4cG9ydCBkZWZhdWx0IHsNCiAgY29tcG9uZW50czogeyBIb21lTmF2LCBMaXR0bGVIZWFkZXIsIGVkaXRvcjogRWRpdG9yIH0sDQogIGRhdGEoKSB7DQogICAgcmV0dXJuIHsNCiAgICAgIHRvcGljOiAiIiwNCiAgICAgIGFkZENvbW1lbnRJbnB1dDogIiIsDQogICAgICByZXBsaWVzQ29tbWVudDogIiIsDQogICAgICBhZGRUeXBlOiAiIiwNCiAgICB9Ow0KICB9LA0KICBjcmVhdGVkKCkgew0KICAgIC8vIGNvbnNvbGUubG9nKHRoaXMuJHJvdXRlLnBhcmFtcy5pZCk7DQogICAgdGhpcy5nZXRUb3BpYygpOw0KICAgIC8vIHRoaXMuYWxsQ29sbGVjdCgpOw0KICAgIC8vIGNvbnNvbGUubG9nKHRoaXMudG9waWMpOw0KICB9LA0KICBjb21wdXRlZDogew0KICAgIC4uLm1hcFN0YXRlKFsic2luZ1VwIl0pLA0KICB9LA0KICBtZXRob2RzOiB7DQogICAgLy/ojrflj5bmlofnq6DmlbDmja7lubbojrflj5bmmK/lkKbmlLbol4/ngrnotZ7jgIINCiAgICBhc3luYyBnZXRUb3BpYygpIHsNCiAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IGF4aW9zLmdldCgNCiAgICAgICAgYC90b3BpYy8ke3RoaXMuJHJvdXRlLnBhcmFtcy5pZH0/YWNjZXNzdG9rZW49JHtzZXNzaW9uU3RvcmFnZS5nZXRJdGVtKA0KICAgICAgICAgICJhY2Nlc3N0b2tlbiINCiAgICAgICAgKX1gDQogICAgICApOw0KICAgICAgdGhpcy50b3BpYyA9IHJlczsNCiAgICAgIC8vIGNvbnNvbGUubG9nKHJlcyk7DQogICAgfSwNCiAgICAvLyDmt7vliqDor4TorroNCiAgICBhc3luYyBhZGRDb21tZW50KGVsZSkgew0KICAgICAgLy8g54K55Ye76I635Y+W5Yiw6K+E6K66Ow0KICAgICAgLy/liKTmlq3mmK/lkKbkuLrnqboNCiAgICAgIGlmICh0aGlzLmFkZENvbW1lbnRJbnB1dCAhPT0gIiIgfHwgdGhpcy5yZXBsaWVzQ29tbWVudCAhPT0gIiIpIHsNCiAgICAgICAgdmFyIGFjdGl2ZUVkaXRvciA9IHRpbnltY2UuYWN0aXZlRWRpdG9yOw0KICAgICAgICB2YXIgZWRpdEJvZHkgPSBhY3RpdmVFZGl0b3IuZ2V0Qm9keSgpOw0KICAgICAgICBhY3RpdmVFZGl0b3Iuc2VsZWN0aW9uLnNlbGVjdChlZGl0Qm9keSk7DQogICAgICAgIHRoaXMuYWRkQ29tbWVudElucHV0ID0gYWN0aXZlRWRpdG9yLnNlbGVjdGlvbi5nZXRDb250ZW50KHsNCiAgICAgICAgICBmb3JtYXQ6ICJ0ZXh0IiwNCiAgICAgICAgfSk7DQogICAgICAgIHRoaXMucmVwbGllc0NvbW1lbnQgPSBhY3RpdmVFZGl0b3Iuc2VsZWN0aW9uLmdldENvbnRlbnQoew0KICAgICAgICAgIGZvcm1hdDogInRleHQiLA0KICAgICAgICB9KTsNCiAgICAgICAgLy8gY29uc29sZS5sb2codGhpcy5hZGRDb21tZW50SW5wdXQpOw0KICAgICAgICBpZiAoc2Vzc2lvblN0b3JhZ2UuZ2V0SXRlbSgiYWNjZXNzdG9rZW4iKSAhPT0gbnVsbCkgew0KICAgICAgICAgIGxldCBjb21tZW50VGV4dCA9IHt9Ow0KICAgICAgICAgIGlmICh0aGlzLmFkZFR5cGUgPT09ICJvbmx5Iikgew0KICAgICAgICAgICAgY29tbWVudFRleHQgPSB7DQogICAgICAgICAgICAgIGFjY2Vzc3Rva2VuOiBzZXNzaW9uU3RvcmFnZS5nZXRJdGVtKCJhY2Nlc3N0b2tlbiIpLA0KICAgICAgICAgICAgICBjb250ZW50OiB0aGlzLmFkZENvbW1lbnRJbnB1dCwNCiAgICAgICAgICAgIH07DQogICAgICAgICAgfSBlbHNlIGlmICh0aGlzLmFkZFR5cGUgPT09ICJvdGhlciIpIHsNCiAgICAgICAgICAgIGNvbW1lbnRUZXh0ID0gew0KICAgICAgICAgICAgICBhY2Nlc3N0b2tlbjogc2Vzc2lvblN0b3JhZ2UuZ2V0SXRlbSgiYWNjZXNzdG9rZW4iKSwNCiAgICAgICAgICAgICAgY29udGVudDogYEAke2VsZS5hdXRob3IubG9naW5uYW1lfSAke3RoaXMucmVwbGllc0NvbW1lbnR9YCwNCiAgICAgICAgICAgICAgcmVwbHlfaWQ6IGVsZS5yZXBseV9pZCwNCiAgICAgICAgICAgIH07DQogICAgICAgICAgICAvLyBjb25zb2xlLmxvZygi5Y+R5biD5LqG6K+E6K66Iik7DQogICAgICAgICAgfQ0KICAgICAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IGF4aW9zLnBvc3QoDQogICAgICAgICAgICBgL3RvcGljLyR7dGhpcy50b3BpYy5kYXRhLmlkfS9yZXBsaWVzYCwNCiAgICAgICAgICAgIGNvbW1lbnRUZXh0DQogICAgICAgICAgKTsNCiAgICAgICAgICBpZiAocmVzLnN1Y2Nlc3MpIHsNCiAgICAgICAgICAgIC8v5LiN6YeN5paw5Y+R6YCB6K+35rGC5b6I6Zq+5a6M576O5pu05paw5pWw5o2u44CCDQogICAgICAgICAgICBjb25zdCByZXMgPSBhd2FpdCBheGlvcy5nZXQoYC90b3BpYy8ke3RoaXMuJHJvdXRlLnBhcmFtcy5pZH1gKTsNCiAgICAgICAgICAgIHRoaXMudG9waWMgPSByZXM7DQogICAgICAgICAgICB0aGlzLmFkZENvbW1lbnRJbnB1dCA9ICIiOw0KICAgICAgICAgICAgdGhpcy5yZXBsaWVzQ29tbWVudCA9ICIiOw0KICAgICAgICAgICAgdGhpcy4kbWVzc2FnZSh7DQogICAgICAgICAgICAgIG1lc3NhZ2U6ICLmga3llpzkvaDvvIzmiJDlip/lj5HluIPkuobkuIDmnaHor4TorroiLA0KICAgICAgICAgICAgICB0eXBlOiAic3VjY2VzcyIsDQogICAgICAgICAgICB9KTsNCiAgICAgICAgICB9DQogICAgICAgICAgLy8gY29uc29sZS5sb2cocmVzKTsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICB0aGlzLiRtZXNzYWdlKHsNCiAgICAgICAgICAgIG1lc3NhZ2U6ICLor7flhYjnmbvpmYbvvIzlho3ov5vooYzor4TorroiLA0KICAgICAgICAgICAgdHlwZTogIndhcm5pbmciLA0KICAgICAgICAgIH0pOw0KICAgICAgICB9DQogICAgICB9IGVsc2Ugew0KICAgICAgICB0aGlzLiRtZXNzYWdlKHsNCiAgICAgICAgICBtZXNzYWdlOiAi6K+E6K665YaF5a655LiN6IO95Li656m65ZOmIiwNCiAgICAgICAgICB0eXBlOiAid2FybmluZyIsDQogICAgICAgIH0pOw0KICAgICAgfQ0KICAgIH0sDQogICAgYWRkU2VsZkNvbW1lbnQoKSB7DQogICAgICB0aGlzLmFkZFR5cGUgPSAib25seSI7DQogICAgICB0aGlzLmFkZENvbW1lbnQoKTsNCiAgICB9LA0KICAgIC8vIOivhOiuuueCuei1ng0KICAgIGFzeW5jIGNvbW1lbnRVcHMoZWxlLCBpbmRleCkgew0KICAgICAgaWYgKHNlc3Npb25TdG9yYWdlLmdldEl0ZW0oImFjY2Vzc3Rva2VuIikpIHsNCiAgICAgICAgLy/liKTmlq3mmK/lkKbmmK/oh6rlt7ENCiAgICAgICAgaWYgKGVsZS5hdXRob3IubG9naW5uYW1lICE9PSB0aGlzLnNpbmdVcC51c2VyYWxsLmxvZ2lubmFtZSkgew0KICAgICAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IGF4aW9zLnBvc3QoYC9yZXBseS8ke2VsZS5pZH0vdXBzYCwgew0KICAgICAgICAgICAgYWNjZXNzdG9rZW46IHNlc3Npb25TdG9yYWdlLmdldEl0ZW0oImFjY2Vzc3Rva2VuIiksDQogICAgICAgICAgfSk7DQogICAgICAgICAgaWYgKHJlcy5hY3Rpb24gPT09ICJ1cCIpIHsNCiAgICAgICAgICAgIHRoaXMudG9waWMuZGF0YS5yZXBsaWVzW2luZGV4XS51cHMucHVzaCgxKTsNCiAgICAgICAgICAgIHRoaXMudG9waWMuZGF0YS5yZXBsaWVzW2luZGV4XS5pc191cGVkID0gdHJ1ZTsNCiAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgdGhpcy50b3BpYy5kYXRhLnJlcGxpZXNbaW5kZXhdLmlzX3VwZWQgPSBmYWxzZTsNCiAgICAgICAgICAgIHRoaXMudG9waWMuZGF0YS5yZXBsaWVzW2luZGV4XS51cHMucG9wKCk7DQogICAgICAgICAgfQ0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgIHRoaXMuJG1lc3NhZ2Uoew0KICAgICAgICAgICAgbWVzc2FnZTogIuS6su+8jOS4jeiDvee7meiHquW3seeCuei1nuWTpiIsDQogICAgICAgICAgICB0eXBlOiAid2FybmluZyIsDQogICAgICAgICAgfSk7DQogICAgICAgIH0NCiAgICAgIH0gZWxzZSB7DQogICAgICAgIHRoaXMuJG1lc3NhZ2Uoew0KICAgICAgICAgIG1lc3NhZ2U6ICLor7flhYjnmbvpmYbvvIzlho3ov5vooYzngrnotZ4iLA0KICAgICAgICAgIHR5cGU6ICJ3YXJuaW5nIiwNCiAgICAgICAgfSk7DQogICAgICB9DQogICAgfSwNCiAgICAvL+WbnuWkjeivhOiuug0KICAgIHJlcGx5Q29tbWVudChpbmRleCkgew0KICAgICAgaWYgKHNlc3Npb25TdG9yYWdlLmdldEl0ZW0oImFjY2Vzc3Rva2VuIikpIHsNCiAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgLmVkaXRvciR7aW5kZXh9YCkuc3R5bGUuZGlzcGxheSA9ICJibG9jayI7DQogICAgICB9IGVsc2Ugew0KICAgICAgICB0aGlzLiRtZXNzYWdlKHsNCiAgICAgICAgICBtZXNzYWdlOiAi6K+35YWI55m76ZmG77yM5YaN5Zue5aSN6K+E6K66IiwNCiAgICAgICAgICB0eXBlOiAid2FybmluZyIsDQogICAgICAgIH0pOw0KICAgICAgfQ0KICAgIH0sDQogICAgcmVwbHlJcyhlbGUsIGluZGV4KSB7DQogICAgICB0aGlzLmFkZFR5cGUgPSAib3RoZXIiOw0KICAgICAgdGhpcy5hZGRDb21tZW50KGVsZSk7DQogICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGAuZWRpdG9yJHtpbmRleH1gKS5zdHlsZS5kaXNwbGF5ID0gIm5vbmUiOw0KICAgIH0sDQogICAgLy/kvZzogIXor6bmg4UNCiAgICAuLi5tYXBNdXRhdGlvbnMoWyJnZXRVc2VyRGV0YWlscyIsICJnZXRFZGl0VG9waWMiXSksDQogICAgdXNlckRldGFpbHModXNlcikgew0KICAgICAgdGhpcy5nZXRVc2VyRGV0YWlscyh1c2VyKTsNCg0KICAgICAgdGhpcy4kcm91dGVyLnB1c2goYC91c2VyLyR7dXNlcn1gKTsNCiAgICB9LA0KICAgIC8v5pS26JeP5Yqf6IO9DQogICAgLy8g6I635Y+W55So5oi35pS26JeP5YiX6KGoDQogICAgYXN5bmMgYWxsQ29sbGVjdCgpIHsNCiAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IGF4aW9zLmdldCgNCiAgICAgICAgYC90b3BpY19jb2xsZWN0LyR7dGhpcy50b3BpYy5kYXRhLmF1dGhvci5sb2dpbm5hbWV9YA0KICAgICAgKTsNCiAgICAgIC8vIGNvbnNvbGUubG9nKHJlcyk7DQogICAgfSwNCiAgICAvL+a3u+WKoOWPlua2iOaUtuiXjw0KICAgIGFkZENvbGxlY3Rpb24oKSB7DQogICAgICBsZXQgcG9zdHNyYyA9ICIiOw0KICAgICAgaWYgKHRoaXMudG9waWMuZGF0YS5pc19jb2xsZWN0KSB7DQogICAgICAgIHBvc3RzcmMgPSAiZGVfY29sbGVjdCI7DQogICAgICAgIHRoaXMudG9waWMuZGF0YS5pc19jb2xsZWN0ID0gZmFsc2U7DQogICAgICB9IGVsc2Ugew0KICAgICAgICBwb3N0c3JjID0gImNvbGxlY3QiOw0KICAgICAgICB0aGlzLnRvcGljLmRhdGEuaXNfY29sbGVjdCA9IHRydWU7DQogICAgICB9DQogICAgICBheGlvcy5wb3N0KGAvdG9waWNfY29sbGVjdC8ke3Bvc3RzcmN9YCwgew0KICAgICAgICBhY2Nlc3N0b2tlbjogc2Vzc2lvblN0b3JhZ2UuZ2V0SXRlbSgiYWNjZXNzdG9rZW4iKSwNCiAgICAgICAgdG9waWNfaWQ6IHRoaXMudG9waWMuZGF0YS5pZCwNCiAgICAgIH0pOw0KICAgIH0sDQogICAgLy/ot7PovaznvJbovpENCiAgICBjbGlja0VkaXQoKSB7DQogICAgICB0aGlzLmdldEVkaXRUb3BpYyh0aGlzLnRvcGljKTsNCiAgICAgIHRoaXMuJHJvdXRlci5wdXNoKCIvdG9waWMvY3JlYXRlIik7DQogICAgfSwNCiAgfSwNCn07DQo="},{"version":3,"sources":["TopicLong.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA+JA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"TopicLong.vue","sourceRoot":"src/views","sourcesContent":["<template>\r\n  <div class=\"topic-long\">\r\n    <HomeNav>/ 文章</HomeNav>\r\n    <div v-if=\"topic !== ''\" class=\"topic-main\">\r\n      <div class=\"topic-top\">\r\n        <span class=\"type\">{{ topic.data | getTitleType }}</span>\r\n        <span class=\"title\">{{ topic.data.title }}</span>\r\n        <div class=\"title-bottom\">\r\n          <ul>\r\n            <li><span />发布于{{ topic.data.create_at | FromNow }}</li>\r\n            <li\r\n              class=\"authorNews\"\r\n              @click=\"userDetails(topic.data.author.loginname)\"\r\n            >\r\n              <span />作者{{ topic.data.author.loginname }}\r\n            </li>\r\n            <li><span />{{ topic.data.visit_count }}次浏览</li>\r\n            <li>\r\n              <span />最后一次编辑是{{ topic.data.last_reply_at | FromNow }}\r\n            </li>\r\n            <li><span />来自{{ topic.data | fromWhere }}</li>\r\n          </ul>\r\n          <!-- 收藏按钮 -->\r\n          <el-button\r\n            @click=\"addCollection()\"\r\n            v-if=\"singUp.userall\"\r\n            type=\"info\"\r\n            size=\"small\"\r\n          >\r\n            {{ topic.data.is_collect ? \"取消收藏\" : \"收藏\" }}\r\n          </el-button>\r\n        </div>\r\n        <div\r\n          v-if=\"\r\n            singUp.userall !== null &&\r\n            topic.data.author_id === singUp.userall.id\r\n          \"\r\n          class=\"edit-topic\"\r\n        >\r\n          <span @click=\"clickEdit()\" title=\"编辑\" class=\"el-icon-edit\"></span>\r\n        </div>\r\n      </div>\r\n      <div class=\"topic-content\" v-html=\"topic.data.content\"></div>\r\n      <div class=\"topic-comments\">\r\n        <!-- 评论区 -->\r\n        <LittleHeader>{{ topic.data.replies.length }} 回复</LittleHeader>\r\n        <div class=\"main-cuntent\">\r\n          <div\r\n            v-for=\"(ele, index) in topic.data.replies\"\r\n            :key=\"ele.id\"\r\n            class=\"topic-comment\"\r\n          >\r\n            <div class=\"author-cuntent\">\r\n              <div class=\"author-left\">\r\n                <img\r\n                  class=\"authorNews\"\r\n                  @click=\"userDetails(ele.author.loginname)\"\r\n                  :title=\"ele.author.loginname\"\r\n                  :src=\"ele.author.avatar_url\"\r\n                  alt=\"\"\r\n                />\r\n                <div class=\"user-info\">\r\n                  <a class=\"name\" href=\"#\">{{ ele.author.loginname }}</a\r\n                  ><a class=\"time\" href=\"#addcomment\">\r\n                    {{ index + 1 }}楼 {{ ele.create_at | FromNow }}</a\r\n                  >\r\n                  <span\r\n                    v-if=\"ele.author.loginname === topic.data.author.loginname\"\r\n                    class=\"ifauthor\"\r\n                    >作者</span\r\n                  >\r\n                </div>\r\n              </div>\r\n              <!-- 评论操作 -->\r\n              <div class=\"author-right\">\r\n                <span\r\n                  @click=\"commentUps(ele, index)\"\r\n                  title=\"点赞\"\r\n                  :class=\"\r\n                    ele.is_uped ? 'el-icon-thumb active' : 'el-icon-thumb'\r\n                  \"\r\n                ></span>\r\n                <span>{{ ele.ups.length }}</span>\r\n                <span\r\n                  @click=\"replyComment(index)\"\r\n                  title=\"回复\"\r\n                  class=\"el-icon-chat-round\"\r\n                ></span>\r\n              </div>\r\n            </div>\r\n            <div class=\"reply-cuntent\">\r\n              <p v-html=\"ele.content\"></p>\r\n            </div>\r\n            <div :class=\"`commentreply  editor${index}`\">\r\n              <editor\r\n                api-key=\"9mieih2cqsubf30b1omff3w107ojvjfvzhmb7haq4giiy754\"\r\n                v-model=\"repliesComment\"\r\n                :init=\"{\r\n                  height: 250,\r\n                  menubar: false,\r\n                  language: 'zh_CN',\r\n                  resize: 'false',\r\n                  plugins: [\r\n                    'advlist autolink lists link image charmap print preview anchor',\r\n                    'searchreplace visualblocks code fullscreen',\r\n                    'insertdatetime media table paste code help wordcount ',\r\n                  ],\r\n                  toolbar:\r\n                    'undo redo | formatselect | bold italic backcolor | \\\r\n           alignleft aligncenter alignright alignjustify | \\\r\n           bullist numlist outdent indent | removeformat | help',\r\n                }\"\r\n              />\r\n              <div class=\"editor-buttom\">\r\n                <el-button\r\n                  @click=\"replyIs(ele, index)\"\r\n                  :plain=\"true\"\r\n                  type=\"info\"\r\n                  >回复</el-button\r\n                >\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <div class=\"add-comment\" id=\"addcomment\">\r\n        <LittleHeader>添加回复</LittleHeader>\r\n        <div class=\"add-main\">\r\n          <editor\r\n            api-key=\"9mieih2cqsubf30b1omff3w107ojvjfvzhmb7haq4giiy754\"\r\n            v-model=\"addCommentInput\"\r\n            :init=\"{\r\n              height: 350,\r\n              menubar: false,\r\n              language: 'zh_CN',\r\n              resize: 'false',\r\n              plugins: [\r\n                'advlist autolink lists link image charmap print preview anchor',\r\n                'searchreplace visualblocks code fullscreen',\r\n                'insertdatetime media table paste code help wordcount ',\r\n              ],\r\n              toolbar:\r\n                'undo redo | formatselect | bold italic backcolor | \\\r\n           alignleft aligncenter alignright alignjustify | \\\r\n           bullist numlist outdent indent | removeformat | help',\r\n            }\"\r\n          />\r\n          <div class=\"editor-buttom\">\r\n            <el-button @click=\"addSelfComment()\" :plain=\"true\" type=\"info\"\r\n              >回复</el-button\r\n            >\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport axios from \"axios\";\r\nimport HomeNav from \"../components/HomeNav.vue\";\r\nimport LittleHeader from \"../components/LittleHeader.vue\";\r\nimport Editor from \"@tinymce/tinymce-vue\";\r\nimport { mapMutations, mapState } from \"vuex\";\r\nexport default {\r\n  components: { HomeNav, LittleHeader, editor: Editor },\r\n  data() {\r\n    return {\r\n      topic: \"\",\r\n      addCommentInput: \"\",\r\n      repliesComment: \"\",\r\n      addType: \"\",\r\n    };\r\n  },\r\n  created() {\r\n    // console.log(this.$route.params.id);\r\n    this.getTopic();\r\n    // this.allCollect();\r\n    // console.log(this.topic);\r\n  },\r\n  computed: {\r\n    ...mapState([\"singUp\"]),\r\n  },\r\n  methods: {\r\n    //获取文章数据并获取是否收藏点赞。\r\n    async getTopic() {\r\n      const res = await axios.get(\r\n        `/topic/${this.$route.params.id}?accesstoken=${sessionStorage.getItem(\r\n          \"accesstoken\"\r\n        )}`\r\n      );\r\n      this.topic = res;\r\n      // console.log(res);\r\n    },\r\n    // 添加评论\r\n    async addComment(ele) {\r\n      // 点击获取到评论;\r\n      //判断是否为空\r\n      if (this.addCommentInput !== \"\" || this.repliesComment !== \"\") {\r\n        var activeEditor = tinymce.activeEditor;\r\n        var editBody = activeEditor.getBody();\r\n        activeEditor.selection.select(editBody);\r\n        this.addCommentInput = activeEditor.selection.getContent({\r\n          format: \"text\",\r\n        });\r\n        this.repliesComment = activeEditor.selection.getContent({\r\n          format: \"text\",\r\n        });\r\n        // console.log(this.addCommentInput);\r\n        if (sessionStorage.getItem(\"accesstoken\") !== null) {\r\n          let commentText = {};\r\n          if (this.addType === \"only\") {\r\n            commentText = {\r\n              accesstoken: sessionStorage.getItem(\"accesstoken\"),\r\n              content: this.addCommentInput,\r\n            };\r\n          } else if (this.addType === \"other\") {\r\n            commentText = {\r\n              accesstoken: sessionStorage.getItem(\"accesstoken\"),\r\n              content: `@${ele.author.loginname} ${this.repliesComment}`,\r\n              reply_id: ele.reply_id,\r\n            };\r\n            // console.log(\"发布了评论\");\r\n          }\r\n          const res = await axios.post(\r\n            `/topic/${this.topic.data.id}/replies`,\r\n            commentText\r\n          );\r\n          if (res.success) {\r\n            //不重新发送请求很难完美更新数据。\r\n            const res = await axios.get(`/topic/${this.$route.params.id}`);\r\n            this.topic = res;\r\n            this.addCommentInput = \"\";\r\n            this.repliesComment = \"\";\r\n            this.$message({\r\n              message: \"恭喜你，成功发布了一条评论\",\r\n              type: \"success\",\r\n            });\r\n          }\r\n          // console.log(res);\r\n        } else {\r\n          this.$message({\r\n            message: \"请先登陆，再进行评论\",\r\n            type: \"warning\",\r\n          });\r\n        }\r\n      } else {\r\n        this.$message({\r\n          message: \"评论内容不能为空哦\",\r\n          type: \"warning\",\r\n        });\r\n      }\r\n    },\r\n    addSelfComment() {\r\n      this.addType = \"only\";\r\n      this.addComment();\r\n    },\r\n    // 评论点赞\r\n    async commentUps(ele, index) {\r\n      if (sessionStorage.getItem(\"accesstoken\")) {\r\n        //判断是否是自己\r\n        if (ele.author.loginname !== this.singUp.userall.loginname) {\r\n          const res = await axios.post(`/reply/${ele.id}/ups`, {\r\n            accesstoken: sessionStorage.getItem(\"accesstoken\"),\r\n          });\r\n          if (res.action === \"up\") {\r\n            this.topic.data.replies[index].ups.push(1);\r\n            this.topic.data.replies[index].is_uped = true;\r\n          } else {\r\n            this.topic.data.replies[index].is_uped = false;\r\n            this.topic.data.replies[index].ups.pop();\r\n          }\r\n        } else {\r\n          this.$message({\r\n            message: \"亲，不能给自己点赞哦\",\r\n            type: \"warning\",\r\n          });\r\n        }\r\n      } else {\r\n        this.$message({\r\n          message: \"请先登陆，再进行点赞\",\r\n          type: \"warning\",\r\n        });\r\n      }\r\n    },\r\n    //回复评论\r\n    replyComment(index) {\r\n      if (sessionStorage.getItem(\"accesstoken\")) {\r\n        document.querySelector(`.editor${index}`).style.display = \"block\";\r\n      } else {\r\n        this.$message({\r\n          message: \"请先登陆，再回复评论\",\r\n          type: \"warning\",\r\n        });\r\n      }\r\n    },\r\n    replyIs(ele, index) {\r\n      this.addType = \"other\";\r\n      this.addComment(ele);\r\n      document.querySelector(`.editor${index}`).style.display = \"none\";\r\n    },\r\n    //作者详情\r\n    ...mapMutations([\"getUserDetails\", \"getEditTopic\"]),\r\n    userDetails(user) {\r\n      this.getUserDetails(user);\r\n\r\n      this.$router.push(`/user/${user}`);\r\n    },\r\n    //收藏功能\r\n    // 获取用户收藏列表\r\n    async allCollect() {\r\n      const res = await axios.get(\r\n        `/topic_collect/${this.topic.data.author.loginname}`\r\n      );\r\n      // console.log(res);\r\n    },\r\n    //添加取消收藏\r\n    addCollection() {\r\n      let postsrc = \"\";\r\n      if (this.topic.data.is_collect) {\r\n        postsrc = \"de_collect\";\r\n        this.topic.data.is_collect = false;\r\n      } else {\r\n        postsrc = \"collect\";\r\n        this.topic.data.is_collect = true;\r\n      }\r\n      axios.post(`/topic_collect/${postsrc}`, {\r\n        accesstoken: sessionStorage.getItem(\"accesstoken\"),\r\n        topic_id: this.topic.data.id,\r\n      });\r\n    },\r\n    //跳转编辑\r\n    clickEdit() {\r\n      this.getEditTopic(this.topic);\r\n      this.$router.push(\"/topic/create\");\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n<style lang='less'>\r\n.topic-long {\r\n  .topic-main {\r\n    .topic-top {\r\n      margin-top: 30px;\r\n      border-bottom: 1px solid #333;\r\n      padding: 8px 0;\r\n      padding-bottom: 15px;\r\n      span.type {\r\n        font-size: 12px;\r\n        padding: 2px 4px;\r\n        background-color: #6f7579;\r\n        color: white;\r\n        border-radius: 4px;\r\n        margin-right: 10px;\r\n      }\r\n      span.title {\r\n        font-size: 22px;\r\n        font-weight: 700;\r\n        margin: 8px 0;\r\n        line-height: 35px;\r\n      }\r\n      .title-bottom {\r\n        display: flex;\r\n        justify-content: space-between;\r\n        // line-height: 40px;\r\n        button {\r\n          margin-top: 7px;\r\n          height: 28px;\r\n          font-size: 12px;\r\n          line-height: 14px;\r\n          padding: 5px 10px;\r\n        }\r\n      }\r\n      .edit-topic {\r\n        span {\r\n          margin-left: 8px;\r\n          cursor: pointer;\r\n          color: #838383;\r\n          font-weight: 500;\r\n        }\r\n        span:hover {\r\n          color: #333;\r\n        }\r\n      }\r\n      ul {\r\n        margin: 5px 0;\r\n        padding: 0;\r\n        li {\r\n          margin: 8px;\r\n          list-style: disc;\r\n          list-style-position: inside;\r\n          display: inline-block;\r\n          font-size: 12px;\r\n          color: #838383;\r\n          line-height: 16px;\r\n          span {\r\n            display: inline-block;\r\n            margin-bottom: 3px;\r\n            margin-right: 4px;\r\n            width: 4px;\r\n            height: 4px;\r\n            border-radius: 4px;\r\n            background-color: #838383;\r\n          }\r\n        }\r\n      }\r\n    }\r\n    .topic-content {\r\n      color: #333;\r\n      .markdown-text {\r\n        p {\r\n          line-height: 1.7em;\r\n          font-size: 15px;\r\n        }\r\n        ul {\r\n          li {\r\n            font-size: 14px;\r\n            list-style: disc;\r\n            line-height: 28px;\r\n          }\r\n        }\r\n        h1,\r\n        h2 {\r\n          border-bottom: 1px solid #eee;\r\n          line-height: 40px;\r\n        }\r\n        img {\r\n          max-width: 100%;\r\n          height: auto;\r\n        }\r\n        a {\r\n          color: #6f7579;\r\n        }\r\n        a:hover {\r\n          text-decoration: underline;\r\n        }\r\n      }\r\n    }\r\n    .topic-comments {\r\n      margin-top: 30px;\r\n      .main-cuntent {\r\n        border: 1px solid #ccc;\r\n        .topic-comment {\r\n          border-top: 1px solid #f0f0f0;\r\n          .author-cuntent {\r\n            position: relative;\r\n            padding: 10px;\r\n            display: flex;\r\n            justify-content: space-between;\r\n            img {\r\n              width: 30px;\r\n              height: 30px;\r\n              border-radius: 3px;\r\n            }\r\n            .user-info {\r\n              position: absolute;\r\n              top: 10px;\r\n              left: 50px;\r\n              display: inline-block;\r\n              font-size: 12px;\r\n              .name {\r\n                color: #666;\r\n                font-weight: 700;\r\n              }\r\n              .name:hover {\r\n                color: #385f8a;\r\n              }\r\n              .time {\r\n                color: #08c;\r\n              }\r\n              .time:hover {\r\n                text-decoration: underline;\r\n              }\r\n              .ifauthor {\r\n                margin-left: 10px;\r\n                padding: 2px 5px;\r\n                border-radius: 3px;\r\n                color: white;\r\n                background-color: #6f7579;\r\n              }\r\n            }\r\n            .author-right {\r\n              span {\r\n                color: #929790;\r\n                font-size: 14px;\r\n                font-weight: 600;\r\n                margin-right: 5px;\r\n              }\r\n              .el-icon-thumb,\r\n              .el-icon-chat-round {\r\n                cursor: pointer;\r\n              }\r\n              .active {\r\n                color: #000;\r\n              }\r\n            }\r\n          }\r\n          .reply-cuntent {\r\n            // overflow: hidden;\r\n            p {\r\n              padding-right: 15px;\r\n              padding-left: 32px;\r\n              margin-top: -20px;\r\n              margin-bottom: 25px;\r\n              img {\r\n                width: 100%;\r\n                height: auto;\r\n              }\r\n            }\r\n          }\r\n          .commentreply {\r\n            display: none;\r\n            padding-left: 50px;\r\n            .tox-tinymce {\r\n              border: none;\r\n              border-top: 1px solid #ccc;\r\n            }\r\n            .tox-statusbar {\r\n              display: none;\r\n            }\r\n            .editor-buttom {\r\n              height: 40px;\r\n              padding-right: 15px;\r\n              margin-bottom: 15px;\r\n              button {\r\n                float: right;\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n    .add-comment {\r\n      margin-top: 30px;\r\n      .editor-buttom {\r\n        padding: 8px 0;\r\n      }\r\n    }\r\n  }\r\n}\r\n</style>"]}]}