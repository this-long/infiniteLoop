(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6fa4a8de"],{"16be":function(t,e,n){},"61cc":function(t,e,n){"use strict";n.r(e);var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"topic-long"},[n("HomeNav",[t._v("/ 文章")]),""!==t.topic?n("div",{staticClass:"topic-main"},[n("div",{staticClass:"topic-top"},[n("span",{staticClass:"type"},[t._v(t._s(t._f("getTitleType")(t.topic.data)))]),n("span",{staticClass:"title"},[t._v(t._s(t.topic.data.title))]),n("div",{staticClass:"title-bottom"},[n("ul",[n("li",[n("span"),t._v("发布于"+t._s(t._f("FromNow")(t.topic.data.create_at)))]),n("li",{staticClass:"authorNews",on:{click:function(e){return t.userDetails(t.topic.data.author.loginname)}}},[n("span"),t._v("作者"+t._s(t.topic.data.author.loginname)+" ")]),n("li",[n("span"),t._v(t._s(t.topic.data.visit_count)+"次浏览")]),n("li",[n("span"),t._v("最后一次编辑是"+t._s(t._f("FromNow")(t.topic.data.last_reply_at))+" ")]),n("li",[n("span"),t._v("来自"+t._s(t._f("fromWhere")(t.topic.data)))])]),t.singUp.userall?n("el-button",{attrs:{type:"info",size:"small"},on:{click:function(e){return t.addCollection()}}},[t._v(" "+t._s(t.topic.data.is_collect?"取消收藏":"收藏")+" ")]):t._e()],1),null!==t.singUp.userall&&t.topic.data.author_id===t.singUp.userall.id?n("div",{staticClass:"edit-topic"},[n("span",{staticClass:"el-icon-edit",attrs:{title:"编辑"},on:{click:function(e){return t.clickEdit()}}})]):t._e()]),n("div",{staticClass:"topic-content",domProps:{innerHTML:t._s(t.topic.data.content)}}),n("div",{staticClass:"topic-comments"},[n("LittleHeader",[t._v(t._s(t.topic.data.replies.length)+" 回复")]),n("div",{staticClass:"main-cuntent"},t._l(t.topic.data.replies,(function(e,i){return n("div",{key:e.id,staticClass:"topic-comment"},[n("div",{staticClass:"author-cuntent"},[n("div",{staticClass:"author-left"},[n("img",{staticClass:"authorNews",attrs:{title:e.author.loginname,src:e.author.avatar_url,alt:""},on:{click:function(n){return t.userDetails(e.author.loginname)}}}),n("div",{staticClass:"user-info"},[n("a",{staticClass:"name",attrs:{href:"#"}},[t._v(t._s(e.author.loginname))]),n("a",{staticClass:"time",attrs:{href:"#addcomment"}},[t._v(" "+t._s(i+1)+"楼 "+t._s(t._f("FromNow")(e.create_at)))]),e.author.loginname===t.topic.data.author.loginname?n("span",{staticClass:"ifauthor"},[t._v("作者")]):t._e()])]),n("div",{staticClass:"author-right"},[n("span",{class:e.is_uped?"el-icon-thumb active":"el-icon-thumb",attrs:{title:"点赞"},on:{click:function(n){return t.commentUps(e,i)}}}),n("span",[t._v(t._s(e.ups.length))]),n("span",{staticClass:"el-icon-chat-round",attrs:{title:"回复"},on:{click:function(e){return t.replyComment(i)}}})])]),n("div",{staticClass:"reply-cuntent"},[n("p",{domProps:{innerHTML:t._s(e.content)}})]),n("div",{class:"commentreply  editor"+i},[n("editor",{attrs:{"api-key":"9mieih2cqsubf30b1omff3w107ojvjfvzhmb7haq4giiy754",init:{height:250,menubar:!1,language:"zh_CN",resize:"false",plugins:["advlist autolink lists link image charmap print preview anchor","searchreplace visualblocks code fullscreen","insertdatetime media table paste code help wordcount "],toolbar:"undo redo | formatselect | bold italic backcolor |          alignleft aligncenter alignright alignjustify |          bullist numlist outdent indent | removeformat | help"}},model:{value:t.repliesComment,callback:function(e){t.repliesComment=e},expression:"repliesComment"}}),n("div",{staticClass:"editor-buttom"},[n("el-button",{attrs:{plain:!0,type:"info"},on:{click:function(n){return t.replyIs(e,i)}}},[t._v("回复")])],1)],1)])})),0)],1),n("div",{staticClass:"add-comment",attrs:{id:"addcomment"}},[n("LittleHeader",[t._v("添加回复")]),n("div",{staticClass:"add-main"},[n("editor",{attrs:{"api-key":"9mieih2cqsubf30b1omff3w107ojvjfvzhmb7haq4giiy754",init:{height:350,menubar:!1,language:"zh_CN",resize:"false",plugins:["advlist autolink lists link image charmap print preview anchor","searchreplace visualblocks code fullscreen","insertdatetime media table paste code help wordcount "],toolbar:"undo redo | formatselect | bold italic backcolor |          alignleft aligncenter alignright alignjustify |          bullist numlist outdent indent | removeformat | help"}},model:{value:t.addCommentInput,callback:function(e){t.addCommentInput=e},expression:"addCommentInput"}}),n("div",{staticClass:"editor-buttom"},[n("el-button",{attrs:{plain:!0,type:"info"},on:{click:function(e){return t.addSelfComment()}}},[t._v("回复")])],1)],1)],1)]):t._e()],1)},o=[],a=n("1da1"),s=n("5530"),r=(n("96cf"),n("99af"),n("bc3a")),c=n.n(r),l=n("87c4"),u=n("b7a5"),p=n("ca72"),d=n("2f62"),m={components:{HomeNav:l["a"],LittleHeader:u["a"],editor:p["a"]},data:function(){return{topic:"",addCommentInput:"",repliesComment:"",addType:""}},created:function(){this.getTopic()},computed:Object(s["a"])({},Object(d["d"])(["singUp"])),methods:Object(s["a"])(Object(s["a"])({getTopic:function(){var t=this;return Object(a["a"])(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,c.a.get("/topic/".concat(t.$route.params.id,"?accesstoken=").concat(sessionStorage.getItem("accesstoken")));case 2:n=e.sent,t.topic=n;case 4:case"end":return e.stop()}}),e)})))()},addComment:function(t){var e=this;return Object(a["a"])(regeneratorRuntime.mark((function n(){var i,o,a,s,r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(""===e.addCommentInput&&""===e.repliesComment){n.next=25;break}if(i=tinymce.activeEditor,o=i.getBody(),i.selection.select(o),e.addCommentInput=i.selection.getContent({format:"text"}),e.repliesComment=i.selection.getContent({format:"text"}),null===sessionStorage.getItem("accesstoken")){n.next=22;break}return a={},"only"===e.addType?a={accesstoken:sessionStorage.getItem("accesstoken"),content:e.addCommentInput}:"other"===e.addType&&(a={accesstoken:sessionStorage.getItem("accesstoken"),content:"@".concat(t.author.loginname," ").concat(e.repliesComment),reply_id:t.reply_id}),n.next=11,c.a.post("/topic/".concat(e.topic.data.id,"/replies"),a);case 11:if(s=n.sent,!s.success){n.next=20;break}return n.next=15,c.a.get("/topic/".concat(e.$route.params.id));case 15:r=n.sent,e.topic=r,e.addCommentInput="",e.repliesComment="",e.$message({message:"恭喜你，成功发布了一条评论",type:"success"});case 20:n.next=23;break;case 22:e.$message({message:"请先登陆，再进行评论",type:"warning"});case 23:n.next=26;break;case 25:e.$message({message:"评论内容不能为空哦",type:"warning"});case 26:case"end":return n.stop()}}),n)})))()},addSelfComment:function(){this.addType="only",this.addComment()},commentUps:function(t,e){var n=this;return Object(a["a"])(regeneratorRuntime.mark((function i(){var o;return regeneratorRuntime.wrap((function(i){while(1)switch(i.prev=i.next){case 0:if(!sessionStorage.getItem("accesstoken")){i.next=11;break}if(t.author.loginname===n.singUp.userall.loginname){i.next=8;break}return i.next=4,c.a.post("/reply/".concat(t.id,"/ups"),{accesstoken:sessionStorage.getItem("accesstoken")});case 4:o=i.sent,"up"===o.action?(n.topic.data.replies[e].ups.push(1),n.topic.data.replies[e].is_uped=!0):(n.topic.data.replies[e].is_uped=!1,n.topic.data.replies[e].ups.pop()),i.next=9;break;case 8:n.$message({message:"亲，不能给自己点赞哦",type:"warning"});case 9:i.next=12;break;case 11:n.$message({message:"请先登陆，再进行点赞",type:"warning"});case 12:case"end":return i.stop()}}),i)})))()},replyComment:function(t){sessionStorage.getItem("accesstoken")?document.querySelector(".editor".concat(t)).style.display="block":this.$message({message:"请先登陆，再回复评论",type:"warning"})},replyIs:function(t,e){this.addType="other",this.addComment(t),document.querySelector(".editor".concat(e)).style.display="none"}},Object(d["c"])(["getUserDetails","getEditTopic"])),{},{userDetails:function(t){this.getUserDetails(t),this.$router.push("/user/".concat(t))},allCollect:function(){var t=this;return Object(a["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,c.a.get("/topic_collect/".concat(t.topic.data.author.loginname));case 2:e.sent;case 3:case"end":return e.stop()}}),e)})))()},addCollection:function(){var t="";this.topic.data.is_collect?(t="de_collect",this.topic.data.is_collect=!1):(t="collect",this.topic.data.is_collect=!0),c.a.post("/topic_collect/".concat(t),{accesstoken:sessionStorage.getItem("accesstoken"),topic_id:this.topic.data.id})},clickEdit:function(){this.getEditTopic(this.topic),this.$router.push("/topic/create")}})},f=m,h=(n("cbd0"),n("2877")),g=Object(h["a"])(f,i,o,!1,null,null,null);e["default"]=g.exports},"86c6":function(t,e,n){},"87c4":function(t,e,n){"use strict";var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"nav"},[n("router-link",{attrs:{to:"/"}},[t._v("主页 ")]),t._t("default")],2)},o=[],a={},s=a,r=(n("a9bd"),n("2877")),c=Object(r["a"])(s,i,o,!1,null,null,null);e["a"]=c.exports},"8a40":function(t,e,n){},a9bd:function(t,e,n){"use strict";n("8a40")},b7a5:function(t,e,n){"use strict";var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"little-header"},[t._t("default")],2)},o=[],a={},s=a,r=(n("f059"),n("2877")),c=Object(r["a"])(s,i,o,!1,null,null,null);e["a"]=c.exports},c4a9:function(t,e,n){"use strict";(function(t){n.d(e,"a",(function(){return o}));var i=function(){return"undefined"!==typeof window?window:t},o=function(){var t=i();return t&&t.tinymce?t.tinymce:null}}).call(this,n("c8ba"))},ca72:function(t,e,n){"use strict";var i=["onActivate","onAddUndo","onBeforeAddUndo","onBeforeExecCommand","onBeforeGetContent","onBeforeRenderUI","onBeforeSetContent","onBeforePaste","onBlur","onChange","onClearUndos","onClick","onContextMenu","onCopy","onCut","onDblclick","onDeactivate","onDirty","onDrag","onDragDrop","onDragEnd","onDragGesture","onDragOver","onDrop","onExecCommand","onFocus","onFocusIn","onFocusOut","onGetContent","onHide","onInit","onKeyDown","onKeyPress","onKeyUp","onLoadContent","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp","onNodeChange","onObjectResizeStart","onObjectResized","onObjectSelected","onPaste","onPostProcess","onPostRender","onPreProcess","onProgressState","onRedo","onRemove","onReset","onSaveContent","onSelectionChange","onSetAttrib","onSetContent","onShow","onSubmit","onUndo","onVisualAid"],o=function(t){return-1!==i.map((function(t){return t.toLowerCase()})).indexOf(t.toLowerCase())},a=function(t,e,n){Object.keys(e).filter(o).forEach((function(i){var o=e[i];"function"===typeof o&&("onInit"===i?o(t,n):n.on(i.substring(2),(function(t){return o(t,n)})))}))},s=function(t,e){var n=t.$props.modelEvents?t.$props.modelEvents:null,i=Array.isArray(n)?n.join(" "):n;e.on(i||"change input undo redo",(function(){t.$emit("input",e.getContent({format:t.$props.outputFormat}))}))},r=function(t,e,n){var i=e.$props.value?e.$props.value:"",o=e.$props.initialValue?e.$props.initialValue:"";n.setContent(i||(e.initialized?e.cache:o)),e.$watch("value",(function(t,i){n&&"string"===typeof t&&t!==i&&t!==n.getContent({format:e.$props.outputFormat})&&n.setContent(t)})),e.$listeners.input&&s(e,n),a(t,e.$listeners,n),e.initialized=!0},c=0,l=function(t){var e=Date.now(),n=Math.floor(1e9*Math.random());return c++,t+"_"+n+c+String(e)},u=function(t){return null!==t&&"textarea"===t.tagName.toLowerCase()},p=function(t){return"undefined"===typeof t||""===t?[]:Array.isArray(t)?t:t.split(" ")},d=function(t,e){return p(t).concat(p(e))},m=function(t){return null===t||void 0===t},f=function(){return{listeners:[],scriptId:l("tiny-script"),scriptLoaded:!1}},h=function(){var t=f(),e=function(t,e,n,i){var o=e.createElement("script");o.referrerPolicy="origin",o.type="application/javascript",o.id=t,o.src=n;var a=function(){o.removeEventListener("load",a),i()};o.addEventListener("load",a),e.head&&e.head.appendChild(o)},n=function(n,i,o){t.scriptLoaded?o():(t.listeners.push(o),n.getElementById(t.scriptId)||e(t.scriptId,n,i,(function(){t.listeners.forEach((function(t){return t()})),t.scriptLoaded=!0})))},i=function(){t=f()};return{load:n,reinitialize:i}},g=h(),v=n("c4a9"),b={apiKey:String,cloudChannel:String,id:String,init:Object,initialValue:String,inline:Boolean,modelEvents:[String,Array],plugins:[String,Array],tagName:String,toolbar:[String,Array],value:String,disabled:Boolean,tinymceScriptSrc:String,outputFormat:{type:String,validator:function(t){return"html"===t||"text"===t}}},y=function(){return y=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var o in e=arguments[n],e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},y.apply(this,arguments)},C=function(t,e,n){return t(n||"div",{attrs:{id:e}})},_=function(t,e){return t("textarea",{attrs:{id:e},style:{visibility:"hidden"}})},k=function(t){return function(){var e=y(y({},t.$props.init),{readonly:t.$props.disabled,selector:"#"+t.elementId,plugins:d(t.$props.init&&t.$props.init.plugins,t.$props.plugins),toolbar:t.$props.toolbar||t.$props.init&&t.$props.init.toolbar,inline:t.inlineEditor,setup:function(e){t.editor=e,e.on("init",(function(n){return r(n,t,e)})),t.$props.init&&"function"===typeof t.$props.init.setup&&t.$props.init.setup(e)}});u(t.element)&&(t.element.style.visibility="",t.element.style.display=""),Object(v["a"])().init(e)}},w={props:b,created:function(){this.elementId=this.$props.id||l("tiny-vue"),this.inlineEditor=this.$props.init&&this.$props.init.inline||this.$props.inline,this.initialized=!1},watch:{disabled:function(){this.editor.setMode(this.disabled?"readonly":"design")}},mounted:function(){if(this.element=this.$el,null!==Object(v["a"])())k(this)();else if(this.element&&this.element.ownerDocument){var t=this.$props.cloudChannel?this.$props.cloudChannel:"5",e=this.$props.apiKey?this.$props.apiKey:"no-api-key",n=m(this.$props.tinymceScriptSrc)?"https://cdn.tiny.cloud/1/"+e+"/tinymce/"+t+"/tinymce.min.js":this.$props.tinymceScriptSrc;g.load(this.element.ownerDocument,n,k(this))}},beforeDestroy:function(){null!==Object(v["a"])()&&Object(v["a"])().remove(this.editor)},deactivated:function(){var t;this.inlineEditor||(this.cache=this.editor.getContent(),null===(t=Object(v["a"])())||void 0===t||t.remove(this.editor))},activated:function(){!this.inlineEditor&&this.initialized&&k(this)()},render:function(t){return this.inlineEditor?C(t,this.elementId,this.$props.tagName):_(t,this.elementId)}};e["a"]=w},cbd0:function(t,e,n){"use strict";n("86c6")},f059:function(t,e,n){"use strict";n("16be")}}]);
//# sourceMappingURL=chunk-6fa4a8de.c0ed6c42.js.map